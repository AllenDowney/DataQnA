
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Resampling and Logistic Regression &#8212; Data Q&amp;A</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'resample_logit';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Data Q&A</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="index.html">
                    Data Q&A
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Chapters</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="combine_risk.html">Combining Risks</a></li>
<li class="toctree-l1"><a class="reference internal" href="confidence.html">What does a confidence interval mean?</a></li>
<li class="toctree-l1"><a class="reference internal" href="corr_trend.html">What does “strength” mean?</a></li>
<li class="toctree-l1"><a class="reference internal" href="count_data.html">Standard deviation of a count variable</a></li>
<li class="toctree-l1"><a class="reference internal" href="gauss_bayes.html">Estimation with Small Samples</a></li>
<li class="toctree-l1"><a class="reference internal" href="harmonic.html">Bootstrapping the harmonic mean</a></li>
<li class="toctree-l1"><a class="reference internal" href="likert_mean.html">Likert scale analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="log_heterosked.html">Logarithms and heteroskedasticity</a></li>
<li class="toctree-l1"><a class="reference internal" href="low_percentile.html">Bootstrapping percentiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="percentile_rank.html">What is a Percentile Rank?</a></li>
<li class="toctree-l1"><a class="reference internal" href="sample_size.html">Sample Size Selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="standard_dev.html">Which Standard Deviation</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_percentile.html">Testing percentiles</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/AllenDowney/DataQnA" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/resample_logit.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Resampling and Logistic Regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boostrap-sampling">Boostrap sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-resampling-framework">The Resampling Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-bootstrap">Parametric bootstrap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-hybrid-model">The Hybrid Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#which-one-is-right">Which One Is Right?</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="resampling-and-logistic-regression">
<h1>Resampling and Logistic Regression<a class="headerlink" href="#resampling-and-logistic-regression" title="Link to this heading">#</a></h1>
<p>Here’s a <a class="reference external" href="https://www.reddit.com/r/statistics/comments/10ayfm5/q_parametric_bootstrap_for_logistic_regression/">question from Reddit’s statistics forum</a>:</p>
<blockquote>
<div><p>I am trying to do parametric bootstrap for logistic regression but I don’t know what the random error terms should be. I know how to do it with linear regression since the error terms follow a normal distribution. Really appreciate any pointers to resources about this topic.</p>
</div></blockquote>
<p>One of the responses recommends <a class="reference external" href="https://www.scirp.org/journal/paperinformation.aspx?paperid=70962">this paper</a>: “An Application of Bootstrapping in Logistic Regression Model”, by Isaac Akpor Adjei and Rezaul Karim.</p>
<p>The paper suggests two ways to compute the sampling distribution of the parameters of a logistic regression by bootstrap sampling.
They characterize one as parametric and the other as non-parametric, and advise:</p>
<blockquote>
<div><p>The non-parametric bootstrap [relies] on weaker assumptions (or no assumptions at all) about the underlying distribution of the population. Statistical practitioners should use non-parametric procedures only in so far as the assumptions about the underlying distribution are seriously doubtful in their validity. … However, when assumptions are not violated, non-parametric procedures will usually have greater variance (in point estimation), less power (in hypothesis testing), wider intervals (in confidence interval estimation), lower probability of correct selection (in ranking and selection) and higher risk (in decision theory) when compared to a corresponding parametric procedure (Efron and Tibshirani, 1994 [1] ).</p>
</div></blockquote>
<p>The premise of this advice is that the parametric and non-parametric methods are answering the same question in different ways, and that one might be preferred over the other because the results are preferable in one way or another. It is also based on the assumption that the sampling distribution of the parameters – and the statistics derived from it – are uniquely and objectively defined.</p>
<p>I disagree with these premises. The parametric and non-parametric methods they present are based on different modeling decisions, so they compute answers to different questions.
And the models they are based on are only two of many possible models.</p>
<p>To explain what I mean, I will implement the methods they propose and explain the assumptions each is based on. Then I will propose a third method that is a hybrid of the two. I’ll show that all three methods yield different results, and suggest criteria for when one might be preferred over the others.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/AllenDowney/DataQnA/blob/main/nb/resample_logit.ipynb">Click here to run this notebook on Colab</a>.</p>
<p>I’ll download a utilities module with some of my frequently-used functions, and then import the usual libraries.</p>
<div class="cell tag_remove-print docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>

        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">local</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">filename</span>

<span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/DataQnA/raw/main/nb/utils.py&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">utils</span> <span class="kn">import</span> <span class="n">decorate</span>
</pre></div>
</div>
</div>
</div>
<section id="the-data">
<h2>The Data<a class="headerlink" href="#the-data" title="Link to this heading">#</a></h2>
<p>As an example, I’ll use data from the General Social Survey (GSS).
I’ll download an HDF file from the <em>Elements of Data Science</em> repository, which contains a subset of the GSS data that has been resampled to correct for stratified sampling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">basename</span><span class="p">,</span> <span class="n">exists</span>

<span class="k">def</span> <span class="nf">download</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">basename</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="kn">import</span> <span class="n">urlretrieve</span>
        <span class="n">local</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloaded &#39;</span> <span class="o">+</span> <span class="n">local</span><span class="p">)</span>
    
<span class="n">download</span><span class="p">(</span><span class="s1">&#39;https://github.com/AllenDowney/&#39;</span> <span class="o">+</span>
         <span class="s1">&#39;ElementsOfDataScience/raw/master/data/gss_eda.hdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_hdf</span><span class="p">(</span><span class="s1">&#39;gss_eda.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;gss&#39;</span><span class="p">)</span>
<span class="n">gss</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(64814, 8)
</pre></div>
</div>
</div>
</div>
<p>It includes 64,814 respondents and 8 variables for each respondent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>YEAR</th>
      <th>ID_</th>
      <th>AGE</th>
      <th>EDUC</th>
      <th>SEX</th>
      <th>GUNLAW</th>
      <th>GRASS</th>
      <th>REALINC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1972</td>
      <td>1</td>
      <td>23.0</td>
      <td>16.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>18951.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1972</td>
      <td>2</td>
      <td>70.0</td>
      <td>10.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>24366.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1972</td>
      <td>3</td>
      <td>48.0</td>
      <td>12.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>24366.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1972</td>
      <td>4</td>
      <td>27.0</td>
      <td>17.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>30458.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1972</td>
      <td>5</td>
      <td>61.0</td>
      <td>12.0</td>
      <td>2</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>50763.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To demonstrate logistic regression, I’ll use <a class="reference external" href="https://gssdataexplorer.norc.org/variables/285/vshow">one of the questions</a> in the General Social Survey, which asks “Do you think the use of marijuana should be made legal or not?”
The responses are in a column called <code class="docutils literal notranslate"><span class="pre">GRASS</span></code> – here are the values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="p">[</span><span class="s1">&#39;GRASS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>GRASS
2.0    25662
1.0    11884
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>I’ll use StatsModels, which provides a function that does logistic regression.
First we have to recode the dependent variable so <code class="docutils literal notranslate"><span class="pre">1</span></code> means “yes” and <code class="docutils literal notranslate"><span class="pre">0</span></code> means “no”.  We can do that by replacing <code class="docutils literal notranslate"><span class="pre">2</span></code> with <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="p">[</span><span class="s1">&#39;GRASS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s1">&#39;GRASS&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To model quadratic relationships, I’ll add columns that contain the values of <code class="docutils literal notranslate"><span class="pre">AGE</span></code> and <code class="docutils literal notranslate"><span class="pre">EDUC</span></code> squared.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gss</span><span class="p">[</span><span class="s1">&#39;AGE2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">gss</span><span class="p">[</span><span class="s1">&#39;EDUC2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gss</span><span class="p">[</span><span class="s1">&#39;EDUC&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>And I’ll drop the rows that have missing values for the variables we’ll need.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">gss</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">,</span> <span class="s1">&#39;EDUC&#39;</span><span class="p">,</span> <span class="s1">&#39;SEX&#39;</span><span class="p">,</span> <span class="s1">&#39;GUNLAW&#39;</span><span class="p">,</span> <span class="s1">&#39;GRASS&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="logistic-regression">
<h2>Logistic Regression<a class="headerlink" href="#logistic-regression" title="Link to this heading">#</a></h2>
<p>Here are the results of logistic regression with these variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;GRASS ~ AGE + AGE2 + EDUC + EDUC2 + C(SEX)&#39;</span>
<span class="n">result_hat</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">result_hat</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Optimization terminated successfully.
         Current function value: 0.593464
         Iterations 6
</pre></div>
</div>
<div class="output text_html"><table class="simpletable">
<caption>Logit Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>         <td>GRASS</td>      <th>  No. Observations:  </th>   <td> 20475</td>  
</tr>
<tr>
  <th>Model:</th>                 <td>Logit</td>      <th>  Df Residuals:      </th>   <td> 20469</td>  
</tr>
<tr>
  <th>Method:</th>                 <td>MLE</td>       <th>  Df Model:          </th>   <td>     5</td>  
</tr>
<tr>
  <th>Date:</th>            <td>Wed, 08 May 2024</td> <th>  Pseudo R-squ.:     </th>   <td>0.05003</td> 
</tr>
<tr>
  <th>Time:</th>                <td>15:30:02</td>     <th>  Log-Likelihood:    </th>  <td> -12151.</td> 
</tr>
<tr>
  <th>converged:</th>             <td>True</td>       <th>  LL-Null:           </th>  <td> -12791.</td> 
</tr>
<tr>
  <th>Covariance Type:</th>     <td>nonrobust</td>    <th>  LLR p-value:       </th> <td>1.555e-274</td>
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>          <th>coef</th>     <th>std err</th>      <th>z</th>      <th>P>|z|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>   <td>   -1.6788</td> <td>    0.240</td> <td>   -6.988</td> <td> 0.000</td> <td>   -2.150</td> <td>   -1.208</td>
</tr>
<tr>
  <th>C(SEX)[T.2]</th> <td>   -0.3849</td> <td>    0.031</td> <td>  -12.394</td> <td> 0.000</td> <td>   -0.446</td> <td>   -0.324</td>
</tr>
<tr>
  <th>AGE</th>         <td>   -0.0278</td> <td>    0.005</td> <td>   -5.399</td> <td> 0.000</td> <td>   -0.038</td> <td>   -0.018</td>
</tr>
<tr>
  <th>AGE2</th>        <td>    0.0001</td> <td> 5.28e-05</td> <td>    2.190</td> <td> 0.029</td> <td> 1.21e-05</td> <td>    0.000</td>
</tr>
<tr>
  <th>EDUC</th>        <td>    0.2000</td> <td>    0.031</td> <td>    6.412</td> <td> 0.000</td> <td>    0.139</td> <td>    0.261</td>
</tr>
<tr>
  <th>EDUC2</th>       <td>   -0.0029</td> <td>    0.001</td> <td>   -2.450</td> <td> 0.014</td> <td>   -0.005</td> <td>   -0.001</td>
</tr>
</table></div></div>
</div>
<p>To get a sense of what the results look like, we can plot the predicted probability of saying  “yes” as a function of age, for male and female respondents.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">89</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">16</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUC2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;EDUC&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">pred1</span> <span class="o">=</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">pred1</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;SEX&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">pred2</span> <span class="o">=</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">pred2</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;AGE&#39;</span><span class="p">]</span>

<span class="n">pred1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Male&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">pred2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;Female&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Age&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Support for legal marijuana&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07138025c0480c40f40c34065dfbcedbd4543f14e6550bc571ecf4c574c7b1cd.png" src="_images/07138025c0480c40f40c34065dfbcedbd4543f14e6550bc571ecf4c574c7b1cd.png" />
</div>
</div>
<p>Men are more likely to support legalization than women, and younger people more likely than older people.</p>
</section>
<section id="boostrap-sampling">
<h2>Boostrap sampling<a class="headerlink" href="#boostrap-sampling" title="Link to this heading">#</a></h2>
<p>Now let’s implement the method characterized as non-parametric, which is based on bootstrap resampling.
The following function samples the rows of <code class="docutils literal notranslate"><span class="pre">data</span></code> with replacement and runs the regression model on the resampled data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">start_params</span><span class="o">=</span><span class="n">result_hat</span><span class="o">.</span><span class="n">params</span><span class="p">)</span> 

<span class="k">def</span> <span class="nf">bootstrap</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">bootstrapped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bootstrapped</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
</div>
<p>The options sent to <code class="docutils literal notranslate"><span class="pre">fit</span></code> make it run faster, but don’t affect the results by much.</p>
<p>Each time we run this process, the result represents a single draw from the sampling distribution of the parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept     -1.861770
C(SEX)[T.2]   -0.380758
AGE           -0.021963
AGE2           0.000034
EDUC           0.209531
EDUC2         -0.002996
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>By running it many times, we generate a sample from the sampling distribution. <code class="docutils literal notranslate"><span class="pre">pqdm</span></code> runs the sampling process in multiple threads.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">pqdm.threads</span> <span class="kn">import</span> <span class="n">pqdm</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pqdm
    <span class="kn">from</span> <span class="nn">pqdm.threads</span> <span class="kn">import</span> <span class="n">pqdm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">estimates</span> <span class="o">=</span> <span class="n">pqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">),</span> <span class="n">bootstrap</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">sampling_dist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>
<span class="n">sampling_dist</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "982eb036ebff47448ecc0ee6afe386ad", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "431c3f67b9fe452da06242ceb139897f", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "7bc57e4d369a4c598c44ba4c5b633b90", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Intercept</th>
      <th>C(SEX)[T.2]</th>
      <th>AGE</th>
      <th>AGE2</th>
      <th>EDUC</th>
      <th>EDUC2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.861770</td>
      <td>-0.380758</td>
      <td>-0.021963</td>
      <td>0.000034</td>
      <td>0.209531</td>
      <td>-0.002996</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.870006</td>
      <td>-0.343399</td>
      <td>-0.024615</td>
      <td>0.000093</td>
      <td>0.211290</td>
      <td>-0.003338</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.550265</td>
      <td>-0.422493</td>
      <td>-0.031421</td>
      <td>0.000166</td>
      <td>0.196451</td>
      <td>-0.002947</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.913072</td>
      <td>-0.342552</td>
      <td>-0.022696</td>
      <td>0.000073</td>
      <td>0.208549</td>
      <td>-0.002995</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.709399</td>
      <td>-0.385184</td>
      <td>-0.025895</td>
      <td>0.000106</td>
      <td>0.193661</td>
      <td>-0.002584</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here’s what the sampling distribution looks like for one of the parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci90</span> <span class="o">=</span> <span class="n">sampling_dist</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sampling_dist</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">])</span>
<span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ci90</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sampling distribution of a parameter&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6f0e815552ff35fa354b3cff531c99f18bdb1cb28bfbaa6b2cf5f80cd3e25642.png" src="_images/6f0e815552ff35fa354b3cff531c99f18bdb1cb28bfbaa6b2cf5f80cd3e25642.png" />
</div>
</div>
<p>The mean of the sampling distribution should be close to the parameters we estimated with the original dataset, and it is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Sampling mean&quot;</span><span class="p">:</span> <span class="n">sampling_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> 
              <span class="s2">&quot;Estimates&quot;</span><span class="p">:</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">params</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sampling mean</th>
      <th>Estimates</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>-1.699398</td>
      <td>-1.678838</td>
    </tr>
    <tr>
      <th>C(SEX)[T.2]</th>
      <td>-0.379244</td>
      <td>-0.384919</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>-0.027387</td>
      <td>-0.027825</td>
    </tr>
    <tr>
      <th>AGE2</th>
      <td>0.000110</td>
      <td>0.000116</td>
    </tr>
    <tr>
      <th>EDUC</th>
      <td>0.201980</td>
      <td>0.200002</td>
    </tr>
    <tr>
      <th>EDUC2</th>
      <td>-0.002937</td>
      <td>-0.002855</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The standard deviations of the sampling distributions should be close to the standard errors computed by StatsModels, and they are.
Most of them are close enough that the difference probably doesn’t matter in practice.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">standard_errors</span><span class="p">(</span><span class="n">sampling_dist</span><span class="p">,</span> <span class="n">result_hat</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;Sampling std&quot;</span><span class="p">:</span> <span class="n">sampling_dist</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> 
                       <span class="s2">&quot;Standard error&quot;</span><span class="p">:</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">bse</span><span class="p">})</span>
    <span class="n">num</span><span class="p">,</span> <span class="n">den</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">T</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Percent diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">num</span> <span class="o">/</span> <span class="n">den</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_errors</span><span class="p">(</span><span class="n">sampling_dist</span><span class="p">,</span> <span class="n">result_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sampling std</th>
      <th>Standard error</th>
      <th>Percent diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.256191</td>
      <td>0.240243</td>
      <td>6.638413</td>
    </tr>
    <tr>
      <th>C(SEX)[T.2]</th>
      <td>0.036286</td>
      <td>0.031057</td>
      <td>16.838207</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>0.004992</td>
      <td>0.005153</td>
      <td>-3.141741</td>
    </tr>
    <tr>
      <th>AGE2</th>
      <td>0.000052</td>
      <td>0.000053</td>
      <td>-1.399085</td>
    </tr>
    <tr>
      <th>EDUC</th>
      <td>0.034325</td>
      <td>0.031193</td>
      <td>10.041461</td>
    </tr>
    <tr>
      <th>EDUC2</th>
      <td>0.001263</td>
      <td>0.001166</td>
      <td>8.386875</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Of course, there is nothing magic about the standard errors computed by StatsModels – they are approximations based on a model of the sampling process, just like the results from resampling.</p>
</section>
<section id="the-resampling-framework">
<h2>The Resampling Framework<a class="headerlink" href="#the-resampling-framework" title="Link to this heading">#</a></h2>
<p>The purpose of the sampling distribution is to quantify the variability in an estimate due to random sampling. It is the answer to the question, “If we ran this sampling process many times, how much would we expect the results to vary?”</p>
<p>To answer that question, we need a model of the sampling process. We use the model to simulate the sampling process and generate counterfactual datasets that represent other samples the process could have generated.</p>
<p>The following figure represents this framework.</p>
<img src="https://github.com/AllenDowney/ElementsOfDataScience/raw/master/figs/resampling.png" width="500"><p>In bootstrap resampling, we treat the rows of the original dataset as if they are the population and draw a random sample from it.
We use this simulated data to compute the sample statistic; in this example, it’s the parameters of the logistic regression model.
We collect the results to form a sample from the sampling distribution, which we can use to compute confidence intervals and standard errors.</p>
<p>This way of simulating the sampling process asks, in effect, what would have happened if we had surveyed different people.
But that’s not the only possible model of the sampling process.
An alternative is to ask what would happen if we surveyed the same people, but they gave different answers.
That’s the model that underlies the parametric method.</p>
</section>
<section id="parametric-bootstrap">
<h2>Parametric bootstrap<a class="headerlink" href="#parametric-bootstrap" title="Link to this heading">#</a></h2>
<p>So, how do we simulate a sampling process where we survey the same people, but they give different answers?
One way is to assume, for the purposes of the simulation, that the parameters we estimated from the original data are correct.
If so, we can use the regression model to compute the predicted probability for each respondent, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pi_hat</span> <span class="o">=</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">pi_hat</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    20475.000000
mean         0.317167
std          0.113654
min          0.025989
25%          0.234792
50%          0.317927
75%          0.400791
max          0.630366
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Now we can use these probabilities to generate a biased coin toss for each respondent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bernoulli</span>

<span class="n">simulated</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">pi_hat</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">simulated</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.3184371184371184
</pre></div>
</div>
</div>
</div>
<p>Then we can run the regression model with these simulated values as the dependent variable.
The following function shows how.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bootstrap2</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">flipped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">GRASS</span><span class="o">=</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">pi_hat</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">flipped</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
</div>
<p>Again, the result from a single simulation is a random value from the sampling distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept     -1.441101
C(SEX)[T.2]   -0.337146
AGE           -0.025234
AGE2           0.000088
EDUC           0.155658
EDUC2         -0.001490
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>If we run it many times, we get a sample from the sampling distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pqdm.threads</span> <span class="kn">import</span> <span class="n">pqdm</span>

<span class="n">estimates</span> <span class="o">=</span> <span class="n">pqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">),</span> <span class="n">bootstrap2</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "db155459cf7d45039a57df608eba9015", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "01ee89c1f2334429b0c065db43ab62a1", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "81aedbf31ee54d76b0b221b253be5439", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampling_dist2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>
<span class="n">sampling_dist2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Intercept</th>
      <th>C(SEX)[T.2]</th>
      <th>AGE</th>
      <th>AGE2</th>
      <th>EDUC</th>
      <th>EDUC2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.607550</td>
      <td>-0.337807</td>
      <td>-0.030948</td>
      <td>0.000152</td>
      <td>0.194980</td>
      <td>-0.002592</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.744398</td>
      <td>-0.371315</td>
      <td>-0.030606</td>
      <td>0.000140</td>
      <td>0.214210</td>
      <td>-0.003249</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.028428</td>
      <td>-0.382518</td>
      <td>-0.023002</td>
      <td>0.000059</td>
      <td>0.247973</td>
      <td>-0.004799</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.888331</td>
      <td>-0.388846</td>
      <td>-0.028548</td>
      <td>0.000146</td>
      <td>0.234939</td>
      <td>-0.004520</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.488713</td>
      <td>-0.391091</td>
      <td>-0.028701</td>
      <td>0.000100</td>
      <td>0.187119</td>
      <td>-0.002527</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here’s the sampling distribution for a single parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci90</span> <span class="o">=</span> <span class="n">sampling_dist2</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sampling_dist2</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">])</span>
<span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ci90</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sampling distribution of a parameter&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c20acf887c6c597aa098870c4585408ea7630731bc3a27b746d07af8d5a725df.png" src="_images/c20acf887c6c597aa098870c4585408ea7630731bc3a27b746d07af8d5a725df.png" />
</div>
</div>
<p>Again, the standard deviations should be close to the standard errors, and they are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_errors</span><span class="p">(</span><span class="n">sampling_dist2</span><span class="p">,</span> <span class="n">result_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sampling std</th>
      <th>Standard error</th>
      <th>Percent diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.213665</td>
      <td>0.240243</td>
      <td>-11.062937</td>
    </tr>
    <tr>
      <th>C(SEX)[T.2]</th>
      <td>0.028567</td>
      <td>0.031057</td>
      <td>-8.015624</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>0.004358</td>
      <td>0.005153</td>
      <td>-15.429475</td>
    </tr>
    <tr>
      <th>AGE2</th>
      <td>0.000047</td>
      <td>0.000053</td>
      <td>-10.980252</td>
    </tr>
    <tr>
      <th>EDUC</th>
      <td>0.030602</td>
      <td>0.031193</td>
      <td>-1.892655</td>
    </tr>
    <tr>
      <th>EDUC2</th>
      <td>0.001166</td>
      <td>0.001166</td>
      <td>-0.006701</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>So we have two models of the sampling process that yield different sampling distributions. But these are not the only models.</p>
<p>If the first method asks, “What if we surveyed different people?” and the second asks “What if we surveyed the same people and they gave different answers?”, let’s consider a third method that asks “¿Por qué no los dos?”.</p>
</section>
<section id="the-hybrid-model">
<h2>The Hybrid Model<a class="headerlink" href="#the-hybrid-model" title="Link to this heading">#</a></h2>
<p>The following function uses bootstrap sampling to simulate surveying different people; then it uses the parametric method to simulate their responses.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bootstrap3</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">bootstrapped</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">pi_hat</span> <span class="o">=</span> <span class="n">result_hat</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">bootstrapped</span><span class="p">)</span>
    <span class="n">flipped</span> <span class="o">=</span> <span class="n">bootstrapped</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">GRASS</span><span class="o">=</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">pi_hat</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">flipped</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bootstrap3</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Intercept     -1.175861
C(SEX)[T.2]   -0.381466
AGE           -0.037683
AGE2           0.000208
EDUC           0.153999
EDUC2         -0.001051
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pqdm.threads</span> <span class="kn">import</span> <span class="n">pqdm</span>

<span class="n">estimates</span> <span class="o">=</span> <span class="n">pqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">),</span> <span class="n">bootstrap3</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "2cf41f196bb944cfbbdc2aa6eaa0449e", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "78949c367a6d4dbea7693291419ecb48", "version_major": 2, "version_minor": 0}</script><script type="application/vnd.jupyter.widget-view+json">{"model_id": "c01bb4a2a8854fcbaf0711fc5b2acd29", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampling_dist3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">estimates</span><span class="p">)</span>
<span class="n">sampling_dist3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Intercept</th>
      <th>C(SEX)[T.2]</th>
      <th>AGE</th>
      <th>AGE2</th>
      <th>EDUC</th>
      <th>EDUC2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.292261</td>
      <td>-0.415617</td>
      <td>-0.029380</td>
      <td>0.000135</td>
      <td>0.150813</td>
      <td>-0.001118</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.703202</td>
      <td>-0.351606</td>
      <td>-0.028947</td>
      <td>0.000139</td>
      <td>0.209984</td>
      <td>-0.003611</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.236159</td>
      <td>-0.417756</td>
      <td>-0.034266</td>
      <td>0.000176</td>
      <td>0.154023</td>
      <td>-0.000940</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.894601</td>
      <td>-0.314302</td>
      <td>-0.018581</td>
      <td>0.000029</td>
      <td>0.183858</td>
      <td>-0.001909</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.290408</td>
      <td>-0.425398</td>
      <td>-0.036473</td>
      <td>0.000200</td>
      <td>0.169032</td>
      <td>-0.001666</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here’s the sampling distribution for one of the parameters.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ci90</span> <span class="o">=</span> <span class="n">sampling_dist3</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">sampling_dist3</span><span class="p">[</span><span class="s1">&#39;C(SEX)[T.2]&#39;</span><span class="p">])</span>
<span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ci90</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sampling distribution of a parameter&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5e43ba56bbd241dfa31e790177809e90afb171e4c68b2ba96eeec2679a99b8d5.png" src="_images/5e43ba56bbd241dfa31e790177809e90afb171e4c68b2ba96eeec2679a99b8d5.png" />
</div>
</div>
<p>Again, the standard errors are comparable to the ones computed by StatsModels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">standard_errors</span><span class="p">(</span><span class="n">sampling_dist3</span><span class="p">,</span> <span class="n">result_hat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Sampling std</th>
      <th>Standard error</th>
      <th>Percent diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Intercept</th>
      <td>0.219808</td>
      <td>0.240243</td>
      <td>-8.506060</td>
    </tr>
    <tr>
      <th>C(SEX)[T.2]</th>
      <td>0.033729</td>
      <td>0.031057</td>
      <td>8.604600</td>
    </tr>
    <tr>
      <th>AGE</th>
      <td>0.005016</td>
      <td>0.005153</td>
      <td>-2.659318</td>
    </tr>
    <tr>
      <th>AGE2</th>
      <td>0.000050</td>
      <td>0.000053</td>
      <td>-5.090008</td>
    </tr>
    <tr>
      <th>EDUC</th>
      <td>0.027835</td>
      <td>0.031193</td>
      <td>-10.764824</td>
    </tr>
    <tr>
      <th>EDUC2</th>
      <td>0.001079</td>
      <td>0.001166</td>
      <td>-7.466320</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now we have four ways to compute sampling distributions, confidence intervals, and standard errors – and they yield different results. So you might wonder…</p>
</section>
<section id="which-one-is-right">
<h2>Which One Is Right?<a class="headerlink" href="#which-one-is-right" title="Link to this heading">#</a></h2>
<p>None of them are right.
They are based on different models of the sampling process, so they quantify different sources of uncertainty.</p>
<p>In some cases we might find that different methods converge on the same results, eventually, under certain assumptions.
But eventually doesn’t really matter – with finite data sets, the results are not generally the same.
So the important question is whether the differences are big enough to matter.</p>
<p>In this example, it is easy to implement multiple models and compare the results.
If they were substantially different, we would need to think more carefully about the modeling assumptions they are based on and choose the one we think is the best description of the data-generating process.</p>
<p>But in this example, the differences are small enough that they probably don’t matter in practice.
So we are free to choose whichever is easiest to implement, or fastest to compute, or convenient in some other way.</p>
<p>It is a common error to presume that the result of an analytic method is uniquely correct, and that results from computational methods like resampling are approximations to it.
Analytic methods are often fast to compute, but they are always based on modeling assumptions and usually based on approximations, so they are no more correct than computational methods.</p>
<p><a class="reference external" href="https://allendowney.github.io/DataQnA/index.html"><em>Data Q&amp;A: Answering the real questions with Python</em></a></p>
<p>Copyright 2024 <a class="reference external" href="https://allendowney.com">Allen B. Downey</a></p>
<p>License: <a class="reference external" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-data">The Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logistic-regression">Logistic Regression</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#boostrap-sampling">Boostrap sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-resampling-framework">The Resampling Framework</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#parametric-bootstrap">Parametric bootstrap</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-hybrid-model">The Hybrid Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#which-one-is-right">Which One Is Right?</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Allen B. Downey
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>